{"version":3,"file":"Register-Dkj6bK2b.js","sources":["../../src/pages/auth/Register.jsx"],"sourcesContent":["import React, { useState } from 'react'\nimport { Link, useNavigate } from 'react-router-dom'\nimport { useForm } from 'react-hook-form'\nimport { Eye, EyeOff, Mail, Lock, User, Store } from 'lucide-react'\nimport { useAuth } from '../../contexts/AuthContext'\nimport { useAuthError } from '../../components/ui/AuthErrorModal'\nimport LoadingSpinner from '../../components/ui/LoadingSpinner'\nimport Modal from '../../components/ui/Modal'\nimport Alert from '../../components/ui/Alert'\nimport toast from 'react-hot-toast'\n\nconst Register = ({ onRequestLogin }) => {\n  const [showPassword, setShowPassword] = useState(false)\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false)\n  const [showVerifyModal, setShowVerifyModal] = useState(false)\n  const [registeredEmail, setRegisteredEmail] = useState('')\n  const { signUp, loading } = useAuth()\n  const { showError } = useAuthError()\n  const navigate = useNavigate()\n  \n  const {\n    register,\n    handleSubmit,\n    watch,\n    formState: { errors },\n    setError\n  } = useForm()\n\n  const password = watch('password')\n\n  const onSubmit = async (data) => {\n    if (data.password !== data.confirmPassword) {\n      setError('confirmPassword', {\n        type: 'manual',\n        message: 'Passwords do not match'\n      });\n      \n      showError(\n        'Registration Error',\n        'Passwords do not match. Please ensure both passwords are identical.',\n        'error'\n      );\n      return;\n    }\n\n    console.log('üöÄ Starting user registration with data:', {\n      email: data.email,\n      fullName: data.fullName,\n      storeName: data.storeName,\n      role: 'owner'\n    });\n\n    try {\n      const result = await signUp(data.email, data.password, {\n        full_name: data.fullName,\n        store_name: data.storeName,\n        role: 'owner'\n      });\n      \n      console.log('üìä Registration result:', result);\n      \n      if (result?.error) {\n        console.error('‚ùå Registration error:', result.error);\n        \n        // Show modal error\n        showError(\n          'Registration Failed',\n          result.error.message || 'Registration failed. Please try again.',\n          'error'\n        );\n        \n        // Also set form error\n        setError('root', { \n          type: 'manual', \n          message: result.error.message || 'Registration failed' \n        });\n      } else {\n        console.log('‚úÖ Registration successful!')\n        \n        // Inform user to verify email before logging in\n        const emailToShow = result?.data?.user?.email || data.email\n        setRegisteredEmail(emailToShow)\n        setShowVerifyModal(true)\n        \n        toast.success('Account created! Please check your email to verify your account.', {\n          duration: 5000\n        })\n      }\n    } catch (error) {\n      console.error('üí• Registration exception:', error);\n      \n      // Show modal error\n      showError(\n        'Registration Error',\n        error.message || 'An unexpected error occurred. Please try again.',\n        'error'\n      );\n      \n      // Also set form error\n      setError('root', { \n        type: 'manual', \n        message: 'Registration failed: ' + error.message \n      });\n    }\n  }\n\n  if (loading) {\n    return <LoadingSpinner text=\"Creating account...\" />\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Create your account</h2>\n        <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-300\">\n          Set up your POS system in minutes\n        </p>\n      </div>\n\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n        {/* Full Name */}\n        <div>\n          <label className=\"label\">\n            Full Name\n          </label>\n          <div className=\"relative\">\n            <User className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n            <input\n              type=\"text\"\n              {...register('fullName', {\n                required: 'Full name is required',\n                minLength: {\n                  value: 2,\n                  message: 'Name must be at least 2 characters'\n                }\n              })}\n              className=\"input pl-10\"\n              placeholder=\"Enter your full name\"\n              autoComplete=\"name\"\n            />\n          </div>\n          {errors.fullName && (\n            <p className=\"mt-1 text-sm text-red-500\">{errors.fullName.message}</p>\n          )}\n        </div>\n\n        {/* Store Name */}\n        <div>\n          <label className=\"label\">\n            Store Name\n          </label>\n          <div className=\"relative\">\n            <Store className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n            <input\n              type=\"text\"\n              {...register('storeName', {\n                required: 'Store name is required',\n                minLength: {\n                  value: 2,\n                  message: 'Store name must be at least 2 characters'\n                }\n              })}\n              className=\"input pl-10\"\n              placeholder=\"Enter your store name\"\n              autoComplete=\"organization\"\n            />\n          </div>\n          {errors.storeName && (\n            <p className=\"mt-1 text-sm text-red-500\">{errors.storeName.message}</p>\n          )}\n        </div>\n\n        {/* Email */}\n        <div>\n          <label className=\"label\">\n            Email address\n          </label>\n          <div className=\"relative\">\n            <Mail className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n            <input\n              type=\"email\"\n              {...register('email', {\n                required: 'Email is required',\n                pattern: {\n                  value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\n                  message: 'Invalid email address'\n                }\n              })}\n              className=\"input pl-10\"\n              placeholder=\"Enter your email\"\n              autoComplete=\"email\"\n            />\n          </div>\n          {errors.email && (\n            <p className=\"mt-1 text-sm text-red-500\">{errors.email.message}</p>\n          )}\n        </div>\n\n        {/* Password */}\n        <div>\n          <label className=\"label\">\n            Password\n          </label>\n          <div className=\"relative\">\n            <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n            <input\n              type={showPassword ? 'text' : 'password'}\n              {...register('password', {\n                required: 'Password is required',\n                minLength: {\n                  value: 6,\n                  message: 'Password must be at least 6 characters'\n                }\n              })}\n              className=\"input pl-10 pr-10\"\n              placeholder=\"Create a password\"\n              autoComplete=\"new-password\"\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n              className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n            >\n              {showPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\n            </button>\n          </div>\n          {errors.password && (\n            <p className=\"mt-1 text-sm text-red-500\">{errors.password.message}</p>\n          )}\n        </div>\n\n        {/* Confirm Password */}\n        <div>\n          <label className=\"label\">\n            Confirm Password\n          </label>\n          <div className=\"relative\">\n            <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n            <input\n              type={showConfirmPassword ? 'text' : 'password'}\n              {...register('confirmPassword', {\n                required: 'Please confirm your password',\n                validate: value => value === password || 'Passwords do not match'\n              })}\n              className=\"input pl-10 pr-10\"\n              placeholder=\"Confirm your password\"\n              autoComplete=\"new-password\"\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n              className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n            >\n              {showConfirmPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\n            </button>\n          </div>\n          {errors.confirmPassword && (\n            <p className=\"mt-1 text-sm text-red-500\">{errors.confirmPassword.message}</p>\n          )}\n        </div>\n\n        {/* Terms and conditions */}\n        <div className=\"flex items-start\">\n          <input\n            id=\"terms\"\n            type=\"checkbox\"\n            {...register('terms', {\n              required: 'You must accept the terms and conditions'\n            })}\n            className=\"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500 mt-0.5\"\n          />\n          <label htmlFor=\"terms\" className=\"ml-2 text-sm text-gray-700\">\n            I agree to the{' '}\n            <a href=\"#\" className=\"text-primary-600 hover:text-primary-500\">\n              Terms and Conditions\n            </a>{' '}\n            and{' '}\n            <a href=\"#\" className=\"text-primary-600 hover:text-primary-500\">\n              Privacy Policy\n            </a>\n          </label>\n        </div>\n        {errors.terms && (\n          <p className=\"mt-1 text-sm text-red-600\">{errors.terms.message}</p>\n        )}\n\n        {/* Error message */}\n        {errors.root && (\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 dark:bg-red-900/20 dark:border-red-800\">\n            <p className=\"text-sm text-red-600 dark:text-red-400\">{errors.root.message}</p>\n          </div>\n        )}\n\n        {/* Submit button */}\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"btn btn-primary btn-lg w-full\"\n        >\n          {loading ? 'Creating account...' : 'Create account'}\n        </button>\n      </form>\n\n      {/* Sign in link */}\n      <div className=\"text-center\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n          Already have an account?{' '}\n          {onRequestLogin ? (\n            <button type=\"button\" onClick={onRequestLogin} className=\"text-primary-500 hover:text-primary-400 font-medium\">Sign in here</button>\n          ) : (\n            <Link to=\"/login\" className=\"text-primary-600 hover:text-primary-500 font-medium\">Sign in here</Link>\n          )}\n        </p>\n      </div>\n\n      {/* Post-signup verification modal */}\n      <Modal\n        isOpen={showVerifyModal}\n        onClose={() => { setShowVerifyModal(false); navigate('/login') }}\n        title=\"Verify your email\"\n        size=\"md\"\n      >\n  <div className=\"p-6 space-y-5\">\n          <Alert\n            type=\"info\"\n            message={`We've sent a verification link to ${registeredEmail || 'your email address'}. Please confirm your email to be able to log in.`}\n          />\n          <div className=\"flex justify-end\">\n            <button\n              className=\"btn btn-primary\"\n              onClick={() => { setShowVerifyModal(false); navigate('/login') }}\n            >\n              Go to Login\n            </button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  )\n}\n\nexport default Register\n"],"names":["Register","onRequestLogin","showPassword","setShowPassword","useState","showConfirmPassword","setShowConfirmPassword","showVerifyModal","setShowVerifyModal","registeredEmail","setRegisteredEmail","signUp","loading","useAuth","showError","useAuthError","navigate","useNavigate","register","handleSubmit","watch","errors","setError","useForm","password","onSubmit","data","result","emailToShow","_b","_a","toast","error","jsx","LoadingSpinner","jsxs","User","Store","Mail","Lock","EyeOff","Eye","value","Link","Modal","Alert"],"mappings":"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"}