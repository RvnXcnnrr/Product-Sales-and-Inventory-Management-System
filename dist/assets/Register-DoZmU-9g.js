import{r as l,a as q,w as A,x as L,c as F,j as e,L as M,i as V,y as g,k as y,E as N,b as O,M as U,l as Z,V as _}from"./index-lSf8Or_v.js";import{U as z}from"./user-QDOL7jJm.js";import{S as I}from"./store-CcBAjp_E.js";const W=({onRequestLogin:x})=>{const[o,f]=l.useState(!1),[i,j]=l.useState(!1),[w,n]=l.useState(!1),[b,v]=l.useState(""),{signUp:P,loading:m}=q(),{showError:c}=A(),u=L(),{register:t,handleSubmit:S,watch:C,formState:{errors:s},setError:d}=F(),E=C("password"),k=async r=>{var p,h;if(r.password!==r.confirmPassword){d("confirmPassword",{type:"manual",message:"Passwords do not match"}),c("Registration Error","Passwords do not match. Please ensure both passwords are identical.","error");return}console.log("🚀 Starting user registration with data:",{email:r.email,fullName:r.fullName,storeName:r.storeName,role:"owner"});try{const a=await P(r.email,r.password,{full_name:r.fullName,store_name:r.storeName,role:"owner"});if(console.log("📊 Registration result:",a),a!=null&&a.error)console.error("❌ Registration error:",a.error),c("Registration Failed",a.error.message||"Registration failed. Please try again.","error"),d("root",{type:"manual",message:a.error.message||"Registration failed"});else{console.log("✅ Registration successful!");const R=((h=(p=a==null?void 0:a.data)==null?void 0:p.user)==null?void 0:h.email)||r.email;v(R),n(!0),_.success("Account created! Please check your email to verify your account.",{duration:5e3})}}catch(a){console.error("💥 Registration exception:",a),c("Registration Error",a.message||"An unexpected error occurred. Please try again.","error"),d("root",{type:"manual",message:"Registration failed: "+a.message})}};return m?e.jsx(M,{text:"Creating account..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Create your account"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:"Set up your POS system in minutes"})]}),e.jsxs("form",{onSubmit:S(k),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",...t("fullName",{required:"Full name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),className:"input pl-10",placeholder:"Enter your full name",autoComplete:"name"})]}),s.fullName&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.fullName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Store Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",...t("storeName",{required:"Store name is required",minLength:{value:2,message:"Store name must be at least 2 characters"}}),className:"input pl-10",placeholder:"Enter your store name",autoComplete:"organization"})]}),s.storeName&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.storeName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email address"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"email",...t("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),className:"input pl-10",placeholder:"Enter your email",autoComplete:"email"})]}),s.email&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:o?"text":"password",...t("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),className:"input pl-10 pr-10",placeholder:"Create a password",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>f(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?e.jsx(y,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})})]}),s.password&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.password.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:i?"text":"password",...t("confirmPassword",{required:"Please confirm your password",validate:r=>r===E||"Passwords do not match"}),className:"input pl-10 pr-10",placeholder:"Confirm your password",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>j(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?e.jsx(y,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})})]}),s.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.confirmPassword.message})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{id:"terms",type:"checkbox",...t("terms",{required:"You must accept the terms and conditions"}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500 mt-0.5"}),e.jsxs("label",{htmlFor:"terms",className:"ml-2 text-sm text-gray-700",children:["I agree to the"," ",e.jsx("a",{href:"#",className:"text-primary-600 hover:text-primary-500",children:"Terms and Conditions"})," ","and"," ",e.jsx("a",{href:"#",className:"text-primary-600 hover:text-primary-500",children:"Privacy Policy"})]})]}),s.terms&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.terms.message}),s.root&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 dark:bg-red-900/20 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:s.root.message})}),e.jsx("button",{type:"submit",disabled:m,className:"btn btn-primary btn-lg w-full",children:m?"Creating account...":"Create account"})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Already have an account?"," ",x?e.jsx("button",{type:"button",onClick:x,className:"text-primary-500 hover:text-primary-400 font-medium",children:"Sign in here"}):e.jsx(O,{to:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign in here"})]})}),e.jsx(U,{isOpen:w,onClose:()=>{n(!1),u("/login")},title:"Verify your email",size:"md",children:e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsx(Z,{type:"info",message:`We've sent a verification link to ${b||"your email address"}. Please confirm your email to be able to log in.`}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>{n(!1),u("/login")},children:"Go to Login"})})]})})]})};export{W as default};
//# sourceMappingURL=Register-DoZmU-9g.js.map
