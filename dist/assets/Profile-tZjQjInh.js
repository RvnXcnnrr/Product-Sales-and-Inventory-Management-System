import{d as g,a as O,r as a,c as C,j as e,X,i as Y,k as $,l as S,E,V as n,s as B}from"./index-Ck3Yh7nW.js";import{P as G}from"./pen-square-B3rpYgz7.js";import{U as y}from"./user-t5OIFp4m.js";import{S as H}from"./save-C_IvSrMN.js";/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=g("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=g("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=g("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),le=()=>{var f,P;const{profile:s,updateProfile:A,updateCredentials:_}=O(),[c,i]=a.useState(!1),[j,x]=a.useState(!1),[m,q]=a.useState(!1),[o,F]=a.useState(!1),[N,p]=a.useState(!1),[U,L]=a.useState(null),[w,M]=a.useState(""),{register:r,handleSubmit:V,reset:D,formState:{errors:b}}=C(),{register:h,handleSubmit:I,reset:v,watch:Z,formState:{errors:t}}=C(),J=Z("newPassword"),R=async l=>{const{error:u}=await A(l);u||i(!1)},T=async l=>{const{currentPassword:u,newPassword:W}=l||{};if(!(s!=null&&s.email)){n.error("Missing email in profile. Please re-login and try again.");return}p(!0);try{const{error:d}=await B.auth.signInWithPassword({email:s.email,password:u});if(d){n.error("Current password is incorrect");return}const{error:k}=await _({password:W});if(k){n.error(k.message||"Failed to change password");return}n.success("Password changed successfully"),L(new Date),M("Your password has been changed successfully."),x(!1),v()}catch(d){n.error((d==null?void 0:d.message)||"Failed to change password")}finally{p(!1)}},z=()=>{i(!1),D()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Profile"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Manage your personal information and account settings"})]}),!c&&e.jsxs("button",{onClick:()=>i(!0),className:"btn btn-primary btn-md mt-4 sm:mt-0",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card p-6 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-primary-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:((f=s==null?void 0:s.full_name)==null?void 0:f.charAt(0))||((P=s==null?void 0:s.email)==null?void 0:P.charAt(0))||"U"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:(s==null?void 0:s.full_name)||"User Name"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:(s==null?void 0:s.role)||"Staff"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2 dark:text-gray-400",children:s==null?void 0:s.email}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Joined ",s!=null&&s.created_at?new Date(s.created_at).toLocaleDateString():"Recently"]}),(s==null?void 0:s.last_sign_in_at)&&e.jsxs("div",{className:"flex items-center justify-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Last active ",new Date(s.last_sign_in_at).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Personal Information"}),c&&e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:z,className:"btn btn-secondary btn-sm",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Cancel"]})})]})}),e.jsx("div",{className:"p-6",children:c?e.jsxs("form",{onSubmit:V(R),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Name"}),e.jsx("input",{...r("full_name",{required:"Full name is required"}),className:"input",defaultValue:s==null?void 0:s.full_name,placeholder:"Enter your full name"}),b.full_name&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.full_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email Address"}),e.jsx("input",{type:"email",...r("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),className:"input",defaultValue:s==null?void 0:s.email,placeholder:"Enter your email",disabled:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Contact support to change your email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone Number"}),e.jsx("input",{type:"tel",...r("phone"),className:"input",defaultValue:s==null?void 0:s.phone,placeholder:"Enter your phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Job Title"}),e.jsx("input",{...r("job_title"),className:"input",defaultValue:s==null?void 0:s.job_title,placeholder:"Enter your job title"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("textarea",{...r("address"),className:"input h-20 resize-none",defaultValue:s==null?void 0:s.address,placeholder:"Enter your address"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",className:"btn btn-primary btn-md",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Full Name"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:(s==null?void 0:s.full_name)||"Not provided"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Y,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email Address"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:(s==null?void 0:s.email)||"Not provided"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Phone Number"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:(s==null?void 0:s.phone)||"Not provided"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Job Title"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:(s==null?void 0:s.job_title)||"Not provided"})]})]})]}),(s==null?void 0:s.address)&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Q,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Address"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.address})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Security"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[w&&e.jsx($,{type:"success",title:"Password updated",message:w,className:"mb-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Password"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last changed ",U?"just now":"30 days ago"]})]}),e.jsx("button",{onClick:()=>x(!j),className:"btn btn-secondary btn-sm",children:"Change Password"})]}),j&&e.jsx("div",{className:"border-t pt-4 dark:border-gray-700",children:e.jsxs("form",{onSubmit:I(T),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",...h("currentPassword",{required:"Current password is required"}),className:"input pr-10",placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>q(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?e.jsx(S,{className:"w-5 h-5"}):e.jsx(E,{className:"w-5 h-5"})})]}),t.currentPassword&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.currentPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o?"text":"password",...h("newPassword",{required:"New password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),className:"input pr-10",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>F(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?e.jsx(S,{className:"w-5 h-5"}):e.jsx(E,{className:"w-5 h-5"})})]}),t.newPassword&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.newPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Confirm New Password"}),e.jsx("input",{type:"password",...h("confirmPassword",{required:"Please confirm your new password",validate:l=>l===J||"Passwords do not match"}),className:"input",placeholder:"Confirm new password"}),t.confirmPassword&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.confirmPassword.message})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{x(!1),v()},className:"btn btn-secondary btn-sm",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm disabled:opacity-60",disabled:N,children:N?"Updating...":"Update Password"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Add extra security to your account"})]}),e.jsx("button",{className:"btn btn-secondary btn-sm",children:"Enable 2FA"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Recent Activity"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Signed in from new device"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"2 hours ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Updated profile information"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"1 day ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Changed password"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"3 days ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Signed in from Chrome on Windows"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"1 week ago"})]})]})})]})]})]})]})};export{le as default};
//# sourceMappingURL=Profile-tZjQjInh.js.map
